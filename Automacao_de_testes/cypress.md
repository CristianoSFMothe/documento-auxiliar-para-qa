# üåê Cypress ‚Äî Automa√ß√£o de Testes E2E

## üìò O que √© o Cypress?

O **Cypress** √© um framework de automa√ß√£o de testes end-to-end moderno, desenvolvido especialmente para aplica√ß√µes web. Ele roda diretamente no navegador e oferece uma experi√™ncia de desenvolvimento rica, com recarregamento autom√°tico, execu√ß√£o visual dos testes e excelente integra√ß√£o com CI/CD.

> Ideal para testes de interface (UI), valida√ß√£o de APIs e testes de comportamento do usu√°rio.

---

## üîó Documenta√ß√£o Oficial

üìö **[Why Cypress? - Documenta√ß√£o Oficial](https://docs.cypress.io/guides/overview/why-cypress)**  
> A explica√ß√£o da proposta do Cypress, com exemplos de uso, vantagens e diferenciais.

---

## üé• Aulas e V√≠deos no YouTube

Para quem prefere aprender na pr√°tica com v√≠deos, aqui est√£o alguns canais com playlists e tutoriais completos:

### üì∫ Canal **QAutomatizado**
üîó [Playlist Cypress para Iniciantes](https://youtu.be/HW8DZD2o68w)  
> S√©rie completa com automa√ß√£o desde o zero, explicando passo a passo como instalar, configurar e automatizar testes com Cypress.

---

### üì∫ Canal **Agilizei**
üîó [Introdu√ß√£o ao Cypress](https://youtu.be/wIjtX0CPaw0)  
> V√≠deo explicando os conceitos iniciais, comandos b√°sicos e execu√ß√£o dos primeiros testes.

---

### üì∫ Canal **QA Hacks e Dicas**
üîó [Playlist de Cypress](https://www.youtube.com/watch?v=XZamVtEwZ_Y&list=PLBzB7PpRjH0oLLflTjpYnj3Dhyw_KFeXR)  
> Diversas aulas com foco pr√°tico em automa√ß√£o, uso de comandos personalizados e dicas para o dia a dia com Cypress.

---

### üì∫ Canal **QA Papito**
üîó [Testes Automatizados com Cypress](https://www.youtube.com/watch?v=FI65wNBKQkE)  
> Tutorial introdut√≥rio e direto ao ponto para come√ßar a automatizar com Cypress em poucos minutos.

---

### üì∫ Canal **Talking About Testing**
üîó [Canal no YouTube](https://www.youtube.com/@TalkingAboutTesting)  
> Conte√∫do aprofundado sobre Cypress, testes de software e qualidade de c√≥digo, com v√≠deos atualizados, boas pr√°ticas e integra√ß√µes com CI/CD.

---

### üì∫ Canal **QAzando**
üîó [Testes Automatizados com Cypress na pr√°tica](https://www.youtube.com/watch?v=3BtGP-DOYqo)  
> Aula pr√°tica sobre como configurar o ambiente, escrever testes e interpretar os resultados no Cypress.

---

## üöÄ Cria√ß√£o de um Projeto com Cypress

### Pr√©-requisitos
- Node.js instalado
- IDE de prefer√™ncia (ex: Visual Studio Code)

---

### 1. Inicializa√ß√£o do Projeto

No terminal, dentro da pasta desejada:

```bash
npm init

# ou

npm init -y
```

Esse comando cria o `package.json`:

```json
{
  "name": "seu-barriga-cypress",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "description": ""
}
```

---

### 2. Instala√ß√£o do Cypress

```bash
npm install cypress@13.13.3 -D
```

> Instala o Cypress como depend√™ncia de desenvolvimento

![instalacao_cypress](https://github.com/user-attachments/assets/6d36a1d7-670d-412e-9700-715df465664e)

---

### 3. Inicializa√ß√£o do Cypress

```bash
npx cypress open
```

> Pode solicitar permiss√µes do firewall, especialmente no Windows.

![permissao_execucao_firewall_windows](https://github.com/user-attachments/assets/d732dc0a-1c7b-4ed6-bad8-9d1de66afd5a)

---

## ‚öôÔ∏è Configura√ß√£o do Cypress

### 1. Tela de Apresenta√ß√£o

![apresentacao_cypress](https://github.com/user-attachments/assets/58190e25-d17d-4b55-9de7-3c3d6efe5157)

---

### 2. Tela de Boas-Vindas

![tela_boas_vindas_cypres](https://github.com/user-attachments/assets/4c39203b-e61b-48a4-91a1-346c4be75f0f)

* Escolha entre **E2E** e **Component**
* Neste guia, focaremos em **E2E**

---

### 3. Estrutura Padr√£o

![estrutura_padrao_cypress](https://github.com/user-attachments/assets/e99a8bdf-2b09-4d1e-b43f-e59dbde81e7f)

---

### 4. Sele√ß√£o de Navegador

![selecao_browser](https://github.com/user-attachments/assets/c41c9a6b-d190-4f50-a909-4b5ad63af469)

---

### 5. Criar um Novo Arquivo de Teste

![criar_novo_spec_de_teste](https://github.com/user-attachments/assets/0afc14be-6b68-47fb-85a1-f9410fb648ac)

---

### 6. Renomear o `cypress\e2e\spec.cy.js` o para ``cypress\e2e\register.cy.js``

![renomear_spec_teste](https://github.com/user-attachments/assets/8f054740-33db-4790-b605-48f91616b704)

---

### 7. Estrutura B√°sica do Arquivo

![estrutura_basica](https://github.com/user-attachments/assets/3c2cfa96-db15-4bdf-b9fa-a69341e241f1)

---

### 8. Primeira Execu√ß√£o

![primeira_execucao](https://github.com/user-attachments/assets/33a4ef06-3cc3-48ea-be2b-b629358a24ea)

---

### 9. Estrutura Final de Pastas

Ap√≥s as configura√ß√µes iniciais, essa ser√° a estrutura esperada:

```text
cypress/
‚îÇ
‚îú‚îÄ‚îÄ e2e/
‚îÇ   ‚îî‚îÄ‚îÄ register.cy.js          # Arquivo de teste E2E
‚îÇ
‚îú‚îÄ‚îÄ fixtures/
‚îÇ   ‚îî‚îÄ‚îÄ example.json            # Massa de dados de exemplo
‚îÇ
‚îú‚îÄ‚îÄ support/
‚îÇ   ‚îú‚îÄ‚îÄ commands.js             # Comandos customizados
‚îÇ   ‚îî‚îÄ‚îÄ e2e.js                  # Arquivo de setup de testes
‚îÇ
node_modules/                   # Pacotes instalados
cypress.config.js               # Arquivo de configura√ß√£o do Cypress
package.json                    # Gerenciador de depend√™ncias
package-lock.json               # Vers√µes exatas das depend√™ncias
```

![estrutura_de_pastas](https://github.com/user-attachments/assets/f89e289b-5a3c-49f4-9c82-3a09b448e819)

---


## ‚úÖ Cria√ß√£o dos Testes

### 1. Teste Simples de Cadastro

Nesta primeira etapa, vamos criar um teste b√°sico de cadastro no site **[SeuBarriga](https://seubarriga.wcaquino.me/login)**, sem usar hooks nem comandos personalizados.

```javascript
describe('Registrar', () => {
  it('deve criar uma conta com sucesso', () => {
    cy.visit('/')

    cy.contains('a', 'Novo usu√°rio?').should('be.visible').click()

    cy.get('input[name="nome"]').should('be.visible').type('QA Cristiano')
    cy.get('input[name="email"]').should('be.visible').type('teste-qa@teste.com')
    cy.get('input[name="senha"]').should('be.visible').type('abc@123')

    cy.contains('input', 'Cadastrar').should('be.visible').click()

    cy.get('.alert-success').should('be.visible')
  })
})
```

![cadastro_com_sucesso](https://github.com/user-attachments/assets/c5a2ceea-64d2-4efc-9fd6-400d64d3fd99)

---

### 2. Teste Simples de Login

Agora, criamos um teste de login usando o mesmo padr√£o:

```javascript
  it('Deve realizar o login com o usu√°rio cadastrado', () => {
    cy.visit('/')

    cy.get('.active > a').should('be.visible')

    cy.get('input[name="email"]').should('be.visible').type('teste-qa-16@teste.com')
    cy.get('input[name="senha"]').should('be.visible').type('abc@123')
    cy.contains('button', 'Entrar').should('be.visible').click()

    cy.get('.alert').should('be.visible')
  });
})
```

![login](https://github.com/user-attachments/assets/a35b2a8c-7c17-4947-af69-e582e4afa35d)

---

### 3. Introdu√ß√£o de Hooks

Perceba que chamamos `cy.visit('/')` em ambos os testes. Para evitar repeti√ß√£o, configuramos a URL base em `cypress.config.js` e usamos hooks:

```javascript
// cypress.config.js
const { defineConfig } = require("cypress");

module.exports = defineConfig({
  e2e: {
    baseUrl: "https://seubarriga.wcaquino.me/login",
    setupNodeEvents(on, config) {
       // implement node event listeners here
    },
  },
});
```

**Hooks** s√£o fun√ß√µes executadas antes ou depois dos testes.  

- `before()` executa **uma vez** antes de todos os testes da spec.  
- `beforeEach()` executa **antes de cada** teste.

Exemplo com `beforeEach()`:

```javascript
describe('Registrar', () => {
  beforeEach(() => {
    // Executado antes de cada it()
    cy.visit('/')
  })

  it('deve criar uma conta com sucesso', () => {

    cy.contains('a', 'Novo usu√°rio?').should('be.visible').click()

    cy.get('input[name="nome"]').should('be.visible').type('QA Cristiano')

    cy.get('input[name="email"]').should('be.visible').type('teste-qa-16@teste.com')

    cy.get('input[name="senha"]').should('be.visible').type('abc@123')

    cy.contains('input', 'Cadastrar').should('be.visible').click()

    cy.get('.alert')
      .should('be.visible')
  })

  it('Deve realizar o login com o usu√°rio cadastrado', () => {

    cy.get('.active > a').should('be.visible')

    cy.get('input[name="email"]').should('be.visible').type('teste-qa-16@teste.com')

    cy.get('input[name="senha"]').should('be.visible').type('abc@123')

    cy.contains('button', 'Entrar').should('be.visible').click()

    cy.get('.alert')
      .should('be.visible')
  });
})
```

> Os hooks tornam o spec mais limpo e garantem que cada teste comece no ponto esperado.

---

### 4. Comandos Personalizados (Custom Commands)

Para reduzir ainda mais a repeti√ß√£o, criamos **Custom Commands** em `cypress/support/commands.js`:

```javascript
// cypress/support/commands.js

Cypress.Commands.add('registoComSucesso', (nome, email, senha) => {
  cy.contains('a', 'Novo usu√°rio?').click()
  cy.get('input[name="nome"]').type(nome)
  cy.get('input[name="email"]').type(email)
  cy.get('input[name="senha"]').type(senha)
  cy.contains('input', 'Cadastrar').click()
})

Cypress.Commands.add('loginComSucesso', (email, senha) => {
  cy.get('input[name="email"]').type(email)
  cy.get('input[name="senha"]').type(senha)
  cy.contains('button', 'Entrar').click()
})

Cypress.Commands.add('mensagemSucesso', () => {
  cy.get('.alert').should('be.visible')
})
```

E importamos em `cypress/support/e2e.js`:

```javascript
import './commands'
```

---

### 5. Testes Refatorados por Partes

**Parte 1: Hooks**

```javascript
describe('Registrar', () => {
  beforeEach(() => {
    cy.visit('/')
  })
  it('deve criar uma conta com sucesso', () => {
    /* c√≥digo de cadastro */
  })
  it('Deve realizar o login com o usu√°rio cadastrado', () => {
    /* c√≥digo de login */
  })
})
```

**Parte 2: Hooks + Custom Commands**

```javascript
describe('Registrar', () => {
  beforeEach(() => {
    cy.visit('/')
  })
  it('deve criar uma conta com sucesso', () => {
    cy.registoComSucesso('QA Cristiano', 'teste-qa@teste.com', 'abc@123')
    cy.mensagemSucesso()
  })
  it('Deve realizar o login com o usu√°rio cadastrado', () => {
    cy.loginComSucesso('teste-qa@teste.com', 'abc@123')
    cy.mensagemSucesso()
  })
})
```

---

### ü™ù Hooks no Cypress

Os **Hooks** no Cypress s√£o fun√ß√µes especiais que permitem executar trechos de c√≥digo em momentos espec√≠ficos do ciclo de vida dos testes. Eles ajudam a manter seu c√≥digo organizado e evitar duplica√ß√£o.

#### Principais Hooks

- **`before(fn)`**  
  Executa uma √∫nica vez **antes** de todos os testes do escopo atual (a suite `describe`).

- **`beforeEach(fn)`**  
  Executa **antes de cada** teste (cada `it`) na suite.

- **`after(fn)`**  
  Executa uma √∫nica vez **ap√≥s** todos os testes do escopo.

- **`afterEach(fn)`**  
  Executa **ap√≥s cada** teste na suite.

---

#### Exemplo Pr√°tico

```javascript
describe('Fluxo de Usu√°rio - Hooks', () => {

  before(() => {
    cy.log('Iniciando testes do fluxo de usu√°rio')
  })

  beforeEach(() => {
    cy.visit('/')
  })

  it('deve criar uma conta com sucesso', () => {
    cy.contains('a', 'Novo usu√°rio?').click()
    cy.get('input[name="nome"]').type('QA Cristiano')
    cy.get('input[name="email"]').type('teste-qa@teste.com')
    cy.get('input[name="senha"]').type('abc@123')
    cy.contains('input', 'Cadastrar').click()
    cy.get('.alert-success').should('be.visible')
  })

  it('deve fazer login com sucesso', () => {
    cy.get('input[name="email"]').type('teste-qa@teste.com')
    cy.get('input[name="senha"]').type('abc@123')
    cy.contains('button', 'Entrar').click()
    cy.get('.alert').should('be.visible')
  })

})
```

---

### üß∞ Recursos Complementares

- :bookmark: [Documenta√ß√£o Cypress](https://docs.cypress.io)
- :open_book: [Frameworks de Teste](./frameworks.md)


